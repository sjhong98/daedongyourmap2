(()=>{var e={};e.id=635,e.ids=[635],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},50852:e=>{"use strict";e.exports=require("async_hooks")},14300:e=>{"use strict";e.exports=require("buffer")},96206:e=>{"use strict";e.exports=require("console")},6113:e=>{"use strict";e.exports=require("crypto")},67643:e=>{"use strict";e.exports=require("diagnostics_channel")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},15673:e=>{"use strict";e.exports=require("node:events")},84492:e=>{"use strict";e.exports=require("node:stream")},47261:e=>{"use strict";e.exports=require("node:util")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},35356:e=>{"use strict";e.exports=require("stream/web")},71576:e=>{"use strict";e.exports=require("string_decoder")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},29830:e=>{"use strict";e.exports=require("util/types")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},63922:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>u});var r=s(73137),a=s(54647),i=s(4183),o=s.n(i),l=s(71775),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);s.d(t,n);let c=r.AppPageRouteModule,u=["",{children:["[location]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,32172)),"/Users/hongseungjae/Desktop/learning.js/daedongyourmap/app/[location]/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,54010)),"/Users/hongseungjae/Desktop/learning.js/daedongyourmap/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/hongseungjae/Desktop/learning.js/daedongyourmap/app/[location]/page.tsx"],p="/[location]/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new c({definition:{kind:a.x.APP_PAGE,page:"/[location]/page",pathname:"/[location]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},7026:(e,t,s)=>{Promise.resolve().then(s.bind(s,2556)),Promise.resolve().then(s.bind(s,29129))},17300:(e,t,s)=>{"use strict";s.d(t,{S:()=>fetchPost});let fetchPost=async(e,t,s)=>{let r=await fetch("https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents:runQuery",{method:"POST",cache:"no-cache",body:JSON.stringify({structuredQuery:{from:[{collectionId:"posts"}],where:{fieldFilter:{field:{fieldPath:"point"},op:"EQUAL",value:{stringValue:`${t}`}}},orderBy:[{field:{fieldPath:"createTime"},direction:"DESCENDING"}]}})}),a=await r.json(),i=[];return a.map(e=>{let t=e.document;void 0!==t&&i.push({createTime:t.createTime,title:t.fields.title.stringValue,content:t.fields.content.stringValue,point:t.fields.point.stringValue,photo:t.fields.photo.arrayValue.values,user:t.fields.user.stringValue,comments:t.fields.comments.arrayValue.values,name:t.name,likes:t.fields.likes.arrayValue.values})}),i}},2556:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>PostBoard});var r=s(60080),a=s(52451),i=s.n(a),o=s(89817),l=s(17300),n=s(9885),c=s(95291),u=s(39093);function PostBoard(e){let[t,s]=(0,n.useState)(),a=(0,c.Zl)(u.curPostStore),[o,p]=(0,n.useState)(e.data),[m,h]=(0,n.useState)(40),[f,x]=(0,n.useState)(80),[g,v]=(0,n.useState)(!1),[j,y]=(0,c.FV)(u.isPostViewOpenStore),handleClickPost=e=>{a(e),y(!0)};return(0,n.useEffect)(()=>{let t=(0,l.S)(m-40,e.location,f-40);t.then(e=>{void 0!==o&&(p([...o,...e]),console.log("post updated",e))})},[j]),(0,n.useEffect)(()=>{let s;return t&&(s=new IntersectionObserver(([t])=>{if(t.isIntersecting){console.log("진입",m,f);let t=(0,l.S)(m,e.location,f);t.then(e=>{void 0!==o&&(p([...o,...e]),h(e=>e+40),x(e=>e+40),v(!0),setTimeout(()=>{v(!1)},2e3))})}},{root:null,threshold:.8})).observe(t),()=>{s&&s.disconnect()}},[t,f]),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-1 min-h-[150vh]",children:[void 0!==o&&o.map((e,t)=>(0,r.jsxs)(d,{className:"center",onClick:()=>handleClickPost(e),children:[r.jsx("p",{className:"absolute text-white nnn opacity-0 z-[100]",children:e.title}),r.jsx("div",{children:r.jsx(i(),{src:void 0!==e.photo&&e.photo[0].stringValue,alt:e.title,width:400,height:400,className:"aspect-square object-cover object-center w-[20vw]"})})]},t)),(0,r.jsxs)("div",{className:"flex flex-col",children:[r.jsx("div",{className:"w-screen min-h-[120vh] flex-1"}),g?r.jsx(r.Fragment,{}):r.jsx("div",{ref:s,className:"w-screen h-[10vh] bg-red-500"})]})]})}let d=o.ZP.div`
    transition: 0.2s ease;
    cursor: pointer;
    &:hover div{
        filter: brightness(.5);
    }
    &:hover p{
        opacity: 1;
    }
`},29129:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>PostView});var r=s(60080),a=s(52451),i=s.n(a),o=s(22723);function PostSlider(e){let t=e.post?.photo,s={dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,nextArrow:r.jsx(function(e){let{className:t,style:s,onClick:a}=e;return r.jsx("div",{className:t,style:{...s,display:"block",filter:"invert(50%)"},onClick:a})},{})};return r.jsx("div",{className:"h-full w-full",children:void 0!==t&&1!==t.length?r.jsx(o.Z,{...s,children:t?.map((e,t)=>r.jsx("div",{className:"w-[40vw] h-[85vh]",children:r.jsx(i(),{src:e.stringValue,alt:"...",width:600,height:600,className:"object-cover max-h-[85vh]"})},t))}):r.jsx("div",{className:"w-[40vw] h-[85vh] flex items-center",children:r.jsx(i(),{src:void 0!==t&&t[0].stringValue,alt:"...",width:600,height:800,className:"object-cover max-h-[85vh]"})},0)})}s(25404),s(66332);var l=s(89817),n=s(8886),c=s(76580),u=s(57734),d=s(43562),p=s(17300);async function removeLike(e,t,s,r){let a;let i=[];0!==s.length&&(i=[...s]);let o=i.findIndex(e=>e.stringValue===a);i.splice(o,1);let l=fetch(`https://firestore.googleapis.com/v1/${e.name}?updateMask.fieldPaths=likes`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({fields:{likes:{arrayValue:{values:i}}}})});return r(i),(await l).json()}async function uploadLike(e,t,s,r){let a=localStorage.getItem("ddym-email"),i=[];0!==s.length&&(i=[...s]),i.push({stringValue:a});let o=fetch(`https://firestore.googleapis.com/v1/${e.name}?updateMask.fieldPaths=likes`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({fields:{likes:{arrayValue:{values:i}}}})});return r(i),(await o).json()}var m=s(9885),h=s(88869),f=s(72856);async function UploadComment(e,t,s,r,a){(0,f.ZF)(h.q);let i=(0,d.v0)(),o=[];0!==r.length&&(o=[...r]),o.push({mapValue:{fields:{user:{stringValue:i.currentUser&&i.currentUser.email},comment:{stringValue:s}}}});let l=fetch(`https://firestore.googleapis.com/v1/${e.name}?updateMask.fieldPaths=comments`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({fields:{comments:{arrayValue:{values:o}}}})});return a(o),(await l).json()}var x=s(95291),g=s(54392),v=s(39093);function PostView(){let e=(0,x.sJ)(v.curPostStore),t=(0,x.sJ)(v.idTokenStore),[s,a]=(0,m.useState)([0]),o=(0,x.sJ)(v.userDataStore),[l,d]=(0,m.useState)([]),[h,f]=(0,m.useState)(""),[y,w]=(0,m.useState)(!1),[N,P]=(0,m.useState)("invisible"),[V,b]=(0,m.useState)(""),[k,_]=(0,x.FV)(v.isPostViewOpenStore);return(0,m.useEffect)(()=>{if(e&&void 0!==e.likes?a([...e.likes]):a([]),e&&void 0!==e.user){(0,g.A)(e.user).then(t=>{void 0!==t&&""!==t.displayName?b(t.displayName):b(e.user)});let t=[...l];e.comments.map((e,s)=>{""!==e.mapValue.fields.user.stringValue&&(0,g.A)(e.mapValue.fields.user.stringValue).then(r=>{console.log("test : ",e.mapValue.fields.user.stringValue,r),void 0!==r&&(t[s].user=r.displayName)})}),d(t)}},[e]),(0,m.useEffect)(()=>{let e;void 0!==localStorage&&localStorage.getItem("ddym-email"),void 0!==s.find(t=>t.stringValue===e)?w(!0):w(!1)},[s]),(0,m.useEffect)(()=>{k?P("flex"):P("invisible")},[k]),r.jsx("div",{id:"outside-view",onClick:e=>{"outside-view"===e.target.id&&(_(!1),d([0]),a([0]),p.S)},className:`w-screen h-screen center fixed backdrop-blur-lg mt-[-20vh] z-[1000] ${N}`,children:(0,r.jsxs)("div",{className:"flex w-[60vw] h-[85vh] bg-white shadow-2xl",children:[r.jsx("div",{className:"flex w-2/3 h-full ",children:r.jsx(PostSlider,{post:e})}),(0,r.jsxs)("div",{className:"w-1/3 h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"p-6 flex-1",children:[(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex nnn",children:[o?.photoURL===void 0?r.jsx(i(),{src:u.Z,alt:"profile",className:"rounded-full w-[1.5vw] mr-3 mt-1"}):r.jsx(r.Fragment,{}),o?.displayName===void 0?r.jsx("p",{children:V}):r.jsx(r.Fragment,{children:o.displayName})]}),(0,r.jsxs)("div",{className:"mt-1 ml-8",children:[r.jsx("p",{className:"nnb",children:e?.title}),r.jsx("p",{className:"text-[0.8rem] nnn",children:e?.content})]})]}),r.jsx("div",{className:"w-full h-full pt-10 overflow-auto",children:void 0!==l&&l.map((e,t)=>(0,r.jsxs)("div",{children:[r.jsx("p",{className:"nnn text-[0.8rem] mt-6",children:void 0!==e.mapValue&&e.mapValue.fields.user.stringValue}),r.jsx("p",{className:"nnn text-[0.7rem]",children:void 0!==e.mapValue&&e.mapValue.fields.comment.stringValue})]},t))})]}),(0,r.jsxs)("div",{className:"flex flex-col h-[10vh] border-t-[1px]",children:[(0,r.jsxs)("div",{className:"flex flex flex-1 mt-1",children:[y?r.jsx(j,{onClick:()=>{e&&removeLike(e,t,s,a)},children:r.jsx(n.Z,{sx:{color:"red"},className:"w-4 mt-[-1vh] ml-3 cursor-pointer"})}):r.jsx(j,{onClick:()=>{e&&""!==s?uploadLike(e,t,s,a):w(!0)},children:r.jsx(c.Z,{sx:{color:"#000"},className:"w-4 mt-[-1vh] ml-3 cursor-pointer"})}),(0,r.jsxs)("p",{className:"nnn text-[0.8rem] ml-1",children:[s.length," 명이 좋아합니다"]})]}),(0,r.jsxs)("div",{className:"flex flex-row",children:[r.jsx("input",{value:h,onChange:e=>f(e.target.value),placeholder:"댓글을 입력하세요",className:"focus:outline-none text-[0.8rem] text-black nnn p-1 pl-4 w-5/6"}),r.jsx("button",{onClick:()=>{e&&""!==h&&UploadComment(e,t,h,l,d).then(e=>{console.log("댓글 추가 성공",e),f("")}).catch(e=>{console.log("댓글 추가 실패",e)})},className:"w-1/6 rounded-xl text-[0.7rem] nnn text-black",children:"입력"})]})]})]})]})})}let j=l.ZP.div`
    transition: 0.15s ease;
    height: 2vh;
    transform-origin: center;
    &:active {
        scale:1.3
    }
`},54392:(e,t,s)=>{"use strict";s.d(t,{A:()=>getProfile});let getProfile=async e=>{let t;console.log("looking for",e,"...");let s=await fetch(`https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents/users/${e}`,{method:"GET"}),r=await s.json();return void 0!==r.field&&(t={displayName:r.fields.displayName.stringValue,photoURL:r.fields.photoURL.stringValue,follower:r.fields.follewer.arrayValue.values,follow:r.fields.follow.arrayValue.values}),t}},32172:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Board});var r=s(48144),a=s(17536);let i=(0,a.createProxy)(String.raw`/Users/hongseungjae/Desktop/learning.js/daedongyourmap/app/[location]/postBoard.tsx`),{__esModule:o,$$typeof:l}=i,n=i.default,c=(0,a.createProxy)(String.raw`/Users/hongseungjae/Desktop/learning.js/daedongyourmap/app/[location]/postView/postView.tsx`),{__esModule:u,$$typeof:d}=c,p=c.default,fetchPost=async(e,t,s)=>{let r=await fetch("https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents:runQuery",{method:"POST",cache:"no-cache",body:JSON.stringify({structuredQuery:{from:[{collectionId:"posts"}],where:{fieldFilter:{field:{fieldPath:"point"},op:"EQUAL",value:{stringValue:`${t}`}}},orderBy:[{field:{fieldPath:"createTime"},direction:"DESCENDING"}]}})}),a=await r.json(),i=[];return a.map(e=>{let t=e.document;void 0!==t&&i.push({createTime:t.createTime,title:t.fields.title.stringValue,content:t.fields.content.stringValue,point:t.fields.point.stringValue,photo:t.fields.photo.arrayValue.values,user:t.fields.user.stringValue,comments:t.fields.comments.arrayValue.values,name:t.name,likes:t.fields.likes.arrayValue.values})}),i},swtichName=e=>{switch(e){case"gyeonggi":return"경기";case"incheon":return"인천";case"seoul":return"서울";case"kyungnam":return"경상남도";case"kyungbuk":return"경상북도";case"jeonnam":return"전라남도";case"jeonbuk":return"전라북도";case"busan":return"부산";case"ulsan":return"울산";case"daegu":return"대구";case"chungbuk":return"충청북도";case"chungnam":return"충청남도";case"gangwon":return"강원";case"gwangju":return"광주";case"daejeon":return"대전";case"jeju":return"제주"}};async function Board(e){let t=e.params.location,s=swtichName(t),a=await fetchPost(0,t);return(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx("p",{className:"text-white text-[2rem] mb-6 nnb",children:s}),r.jsx(n,{data:a,data2:a,location:t}),r.jsx(p,{})]})}},57481:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(96885);let __WEBPACK_DEFAULT_EXPORT__=e=>{let t=(0,r.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[311,885,817,135,666],()=>__webpack_exec__(63922));module.exports=s})();