(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{3295:function(e,t,s){"use strict";var l=s(6314);t.Z=void 0;var o=l(s(984)),a=s(7437);t.Z=(0,o.default)((0,a.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings")},6929:function(e,t,s){Promise.resolve().then(s.bind(s,113))},9783:function(e,t,s){"use strict";s.d(t,{A:function(){return getProfile}});let getProfile=async e=>{let t;console.log("looking for",e,"'s data");let s=await fetch("https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents/users/".concat(e),{method:"GET"}),l=await s.json();return void 0!==l.fields&&(t={displayName:l.fields.displayName.stringValue,photoURL:l.fields.photoURL.stringValue,follower:l.fields.follewer.arrayValue.values,follow:l.fields.follow.arrayValue.values}),t}},113:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Profile}});var l=s(7437),o=s(6691),a=s.n(o),n=s(3295),r=s(6221),i=s(9903),c=s(4033),d=s(2265);let fetchUserPost=async e=>{let t=await fetch("https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents:runQuery",{method:"POST",cache:"no-cache",body:JSON.stringify({structuredQuery:{from:[{collectionId:"posts"}],where:{fieldFilter:{field:{fieldPath:"user"},op:"EQUAL",value:{stringValue:"".concat(e)}}},orderBy:[{field:{fieldPath:"createTime"},direction:"DESCENDING"}]}})}),s=await t.json(),l=[];return s.map(e=>{let t=e.document;void 0!==t&&l.push({createTime:t.createTime,title:t.fields.title.stringValue,content:t.fields.content.stringValue,point:t.fields.point.stringValue,photo:t.fields.photo.arrayValue.values,user:t.fields.user.stringValue,comments:t.fields.comments.arrayValue.values,name:t.name,likes:t.fields.likes.arrayValue.values})}),l};var u=s(9783);function Profile(e){let t;let s=(0,c.useRouter)(),o=e.params.email.replace("%40","@"),f="text-white text-[1rem]";null!==localStorage&&localStorage.getItem("ddym-email");let[h,A]=(0,d.useState)(!1),[m,p]=(0,d.useState)("test"),[g,v]=(0,d.useState)([]),[x,j]=(0,d.useState)([]),[y,w]=(0,d.useState)(!1),[N,S]=(0,d.useState)(!0),[P,k]=(0,d.useState)(""),[C,E]=(0,d.useState)([]),b="text-white nnn mt-4 cursor-pointer";(0,d.useEffect)(()=>{(0,u.A)(o).then(e=>{v(["sjhong98@Icloud.com","elyont98@naver.com","test@test.com"]),j(["sjhong98@Icloud.com","elyont98@naver.com","test@test.com"]),void 0!==e&&(""!==e.displayName&&void 0!==e.displayName?p(e.displayName):p(o),v(["sjhong98@Icloud.com","elyont98@naver.com","test@test.com"]),j(["sjhong98@Icloud.com","elyont98@naver.com","test@test.com"]),""!==e.photoURL&&void 0!==e.photoURL&&k(e.photoURL),o===t?A(!0):A(!1))}),fetchUserPost(o).then(e=>{E(e)})},[]);let handleClickProfile=e=>{s.push("/profile/".concat(e))};return(0,l.jsxs)("div",{className:"flex w-screen h-full",children:[(0,l.jsx)("title",{children:"대동, 너의 지도 | 프로필"}),y?(0,l.jsx)("div",{id:"outside-view",onClick:e=>{"outside-view"===e.target.id&&w(!1)},className:"fixed w-screen h-[100vh] z-[100] center mt-[-20vh] backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"bg-stone-800 w-[25vw] h-[35vh] rounded-2xl shadow-2xl",children:[(0,l.jsx)("div",{className:"border-b-[1px] border-stone-600 w-full h-[4vh] center",children:(0,l.jsx)("p",{className:"text-white nnn",children:N?"팔로우":"팔로워"})}),(0,l.jsx)("div",{className:"p-6",children:N?g.map((e,t)=>(0,l.jsx)("p",{onClick:()=>handleClickProfile(e),className:b,children:e},t)):x.map((e,t)=>(0,l.jsx)("p",{onClick:()=>handleClickProfile(e),className:b,children:e},t))})]})}):(0,l.jsx)(l.Fragment,{}),(0,l.jsxs)("div",{className:"w-1/3 h-full center",children:[h?(0,l.jsx)(r.Z,{}):""===P?(0,l.jsx)(a(),{src:i.Z,width:200,height:200,alt:"...",className:"rounded-full"}):(0,l.jsx)(a(),{src:P,width:200,height:200,alt:"...",className:"rounded-full"}),(0,l.jsxs)("div",{className:"flex flex-col ml-4",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("p",{className:"text-white nnn text-[1.5rem]",children:m}),(0,l.jsx)(n.Z,{className:"cursor-pointer ml-2",onClick:()=>{s.push("/setting/edit")}})]}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("p",{className:"".concat(f," nnn"),children:"팔로우"}),(0,l.jsx)("p",{className:"".concat(f," nnb ml-1 cursor-pointer"),onClick:()=>{w(!0),S(!0)},children:"100"}),(0,l.jsx)("p",{className:"".concat(f," nnn ml-3"),children:"팔로워"}),(0,l.jsx)("p",{className:"".concat(f," nnb ml-1 cursor-pointer"),onClick:()=>{w(!0),S(!0)},children:"100"})]})]})]}),(0,l.jsx)("div",{className:"w-2/3 h-full center",children:"hlelo"})]})}},6221:function(e,t,s){"use strict";s.d(t,{Z:function(){return ProfilePic}});var l=s(7437),o=s(6691),a=s.n(o),n=s(9903),r=s(5883),i=s(2265),c=s(5075),d=s(994),u=s(3085),f=s(9584);let updateProfilePic=(e,t,s,l)=>{t(URL.createObjectURL(e));let o=(0,u.v0)();o.onAuthStateChanged(t=>{if(t&&t.email){(0,d.ZF)(c.q);let o=(0,f.cF)(),a=(0,f.iH)(o,t.email);(0,f.KV)(a,e).then(e=>{let a=e.metadata.fullPath;(0,f.Jt)((0,f.iH)(o,a)).then(e=>{(0,u.ck)(t,{photoURL:e}).then(()=>{console.log("profile pic changed")}).catch(e=>{console.log(e)}),fetch("https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents/users/".concat(l,"?updateMask.fieldPaths=photoURL"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(s)},body:JSON.stringify({fields:{photoURL:{stringValue:e}}})})})})}})};var h=s(62);function ProfilePic(){let e;let[t,s]=(0,i.useState)(),o=(0,r.sJ)(h.profileStore),c=(0,r.sJ)(h.idTokenStore);return null!==localStorage&&localStorage.getItem("ddym-email"),(0,i.useEffect)(()=>{o.photoURL?s(o.photoURL):s(n.Z)},[o]),(0,l.jsxs)("div",{children:[(0,l.jsx)("input",{id:"input-image",type:"file",onChange:t=>{e&&updateProfilePic(t.target.files[0],s,c,e)},accept:".png, .jpg, .jpeg, .HEIC, image/*",className:"hidden"}),(0,l.jsx)("label",{htmlFor:"input-image",children:(0,l.jsx)(a(),{alt:"profile",src:t,width:200,height:200,className:"rounded-full cursor-pointer aspect-square object-cover"})})]})}},62:function(e,t,s){"use strict";s.r(t),s.d(t,{curComments:function(){return r},curPostStore:function(){return u},default:function(){return RecoilContextProvider},idTokenStore:function(){return i},isLoginStore:function(){return n},isPostViewOpenStore:function(){return f},profileStore:function(){return a},selectedPointStore:function(){return d},userDataStore:function(){return c}});var l=s(7437);s(2265);var o=s(5883);let a=(0,o.cn)({key:"profile",default:{}}),n=(0,o.cn)({key:"isLogin",default:!1}),r=(0,o.cn)({key:"curComments",default:""}),i=(0,o.cn)({key:"idTokenStore",default:""}),c=(0,o.cn)({key:"userDataStore",default:null}),d=(0,o.cn)({key:"selectedPointStore",default:""}),u=(0,o.cn)({key:"curPostStore",default:null}),f=(0,o.cn)({key:"isPostViewOpen",default:!1});function RecoilContextProvider(e){let{children:t}=e;return(0,l.jsx)(o.Wh,{children:t})}},5075:function(e,t,s){"use strict";s.d(t,{q:function(){return l}});let l={apiKey:"AIzaSyCA6Q_TA6dyl7wf2BtR_V_oEVIW2_Q94y0",authDomain:"daedongyourmap-ad63d.firebaseapp.com",projectId:"daedongyourmap-ad63d",storageBucket:"daedongyourmap-ad63d.appspot.com",messagingSenderId:"68098855208",appId:"1:68098855208:web:aa0e9a5602074a3b6c401d",measurementId:"G-7X00QEEQ08"}},9903:function(e,t){"use strict";t.Z={src:"/_next/static/media/defaultProfilePic.513224af.jpeg",height:360,width:360,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAeEAABAwQDAAAAAAAAAAAAAAAAEhMVAgMUIjNB8f/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCmSNM+3k3G+NtOqvewAB//2Q==",blurWidth:8,blurHeight:8}}},function(e){e.O(0,[691,380,964,928,795,161,732,584,971,864,744],function(){return e(e.s=6929)}),_N_E=e.O()}]);