(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{4331:function(e,t,n){Promise.resolve().then(n.bind(n,1737))},1737:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var a=n(6093),r=n(3827),l=n(9712),o=n(1590),s=n.n(o),u=n(3656);function i(){let e=(0,a._)(["\n    transition: 0.15s ease;\n    &:hover {\n        background-color: #003545;\n        color: white;\n    }\n"]);return i=function(){return e},e}function c(e){let{image:t,setImage:n}=e,a=async e=>{let a,r=[...t];if(e.target.files){var l;a=await (l=e.target.files[0],new Promise(e=>{s().imageFileResizer(l,1e3,1e3,"JPEG",100,0,t=>{e(t)},"blob")}))}r.push(a),n(r)},l=e=>{let a=[...t];a.splice(e,1),n(a)};return(0,r.jsxs)("div",{className:"w-[20vw] h-[10vh]",children:[(0,r.jsx)("input",{id:"input-image",type:"file",multiple:!0,onChange:a,accept:".png, .jpg, .jpeg, .HEIC, image/*",className:"hidden"}),(0,r.jsx)(d,{htmlFor:"input-image",className:"cursor-pointer lml mc bg-white rounded-md center",children:"upload image"}),(0,r.jsx)("div",{className:"w-full h-full p-2 flex justify-center",children:t.map((e,t)=>{let n=URL.createObjectURL(e);return(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{src:n,alt:"...",className:"h-[5vh] aspect-square object-cover mr-2"}),(0,r.jsx)("div",{className:"absolute w-[1vw] h-[1vw] bg-black mt-[-1.5vh] center cursor-pointer",onClick:()=>l(t),children:(0,r.jsx)(u.Z,{sx:{width:20}})})]},t)})})]})}let d=l.ZP.label(i());var h=n(6910);function f(){return(0,r.jsx)("div",{children:(0,r.jsx)(h.Z,{className:"mb-4"})})}var m=n(697),g=n(651),p=n(2153),v=n(9700);function j(){let[e,t]=(0,p.FV)(v.selectedPointStore);return(0,r.jsxs)(g.Z,{value:e,label:"지역",onChange:e=>{t(e.target.value)},className:"w-[20vw]",sx:{backgroundColor:"white",height:"3vh",marginBottom:"2vh"},children:[(0,r.jsx)(m.Z,{value:"seoul",children:"서울"}),(0,r.jsx)(m.Z,{value:"incheon",children:"인천"}),(0,r.jsx)(m.Z,{value:"gangwon",children:"강원"}),(0,r.jsx)(m.Z,{value:"jeju",children:"제주"}),(0,r.jsx)(m.Z,{value:"gyeonggi",children:"경기"}),(0,r.jsx)(m.Z,{value:"busan",children:"부산"}),(0,r.jsx)(m.Z,{value:"daegu",children:"대구"}),(0,r.jsx)(m.Z,{value:"kyungnam",children:"경상남도"}),(0,r.jsx)(m.Z,{value:"kyungbuk",children:"경상북도"}),(0,r.jsx)(m.Z,{value:"jeonnam",children:"전라남도"}),(0,r.jsx)(m.Z,{value:"jeonbuk",children:"전라북도"}),(0,r.jsx)(m.Z,{value:"chungnam",children:"충청남도"}),(0,r.jsx)(m.Z,{value:"chungbuk",children:"충청북도"}),(0,r.jsx)(m.Z,{value:"daejeon",children:"대전"}),(0,r.jsx)(m.Z,{value:"gwangju",children:"광주"}),(0,r.jsx)(m.Z,{value:"ulsan",children:"울산"})]})}var x=n(7907),w=n(4090);async function b(e){let{title:t,content:n,idToken:a,selectedPoint:r}=e,l=localStorage.getItem("ddym-email"),o={fields:{title:{stringValue:t},content:{stringValue:n},photo:{arrayValue:{values:[]}},time:{stringValue:new Date().toISOString()},point:{stringValue:r},comments:{arrayValue:{values:[]}},likes:{arrayValue:{values:[]}},user:{stringValue:l},createTime:{doubleValue:+new Date}}},s=(await fetch("https://firestore.googleapis.com/v1/projects/daedongyourmap-ad63d/databases/(default)/documents/posts",{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:JSON.stringify(o)})).json();return s.then(e=>e.name).catch(e=>console.log("upload post err : ",e)),s}var y=n(6142),k=n(4905),S=n(8800);function Z(){let e=(0,a._)(["\n    transition: 0.3s ease;\n    &:hover {\n        background-color: #003545;\n        color: white;\n    }\n"]);return Z=function(){return e},e}function P(){let e=(0,a._)(["\n    &:focus {\n        outline: none;\n    }\n"]);return P=function(){return e},e}function N(){let e=(0,a._)(["\n    &:focus {\n        outline: none;\n    }\n"]);return N=function(){return e},e}function C(){let e=(0,x.useRouter)(),t=(0,p.sJ)(v.idTokenStore),n=(0,p.sJ)(v.isLoginStore),a=(0,p.Zl)(v.postCreatedStore),[l,o]=(0,w.useState)([]),[s,u]=(0,w.useState)(""),[i,d]=(0,w.useState)(""),[h,m]=(0,w.useState)(!1),[g,Z]=(0,w.useState)(!1),P=(0,p.sJ)(v.selectedPointStore),N="text-black mb-6 w-[20vw] rounded-md px-3",C=t=>{e.push("/".concat(t))};return(0,w.useEffect)(()=>{n||e.push("/signin")},[]),(0,w.useEffect)(()=>{""!==s&&l.length>0&&""!==P?Z(!0):Z(!1)},[s,l]),(0,r.jsxs)("div",{className:"flex flex-col center bg-stone-800 rounded-2xl w-[40vw] min-h-[60vh] shadow-2xl",children:[(0,r.jsx)("title",{children:"대동, 당신의 지도 | 게시물 작성"}),h?(0,r.jsx)(f,{}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)("p",{className:"text-3xl lml text-white mb-8",children:"New Post"}),(0,r.jsx)(j,{}),(0,r.jsx)(c,{image:l,setImage:o}),(0,r.jsx)(_,{value:s,placeholder:"title",onChange:e=>u(e.target.value),className:N}),(0,r.jsx)(E,{value:i,placeholder:"content",onChange:e=>d(e.target.value),className:N}),h?(0,r.jsx)(r.Fragment,{}):g?(0,r.jsx)(V,{onClick:()=>{b({title:s,content:i,idToken:t,selectedPoint:P}).then(e=>{(function(e,t,n,a,r,l){let o,s;(0,y.ZF)(S.q);let u=(0,k.cF)(),i=[];e.map((e,c)=>{let d="".concat(n,"-").concat(c);s=(0,k.iH)(u,d),(0,k.KV)(s,e).then(e=>{o=e.metadata.fullPath,(0,k.Jt)((0,k.iH)(u,o)).then(e=>{i.push({stringValue:e});let n=o.slice(0,-2);fetch("https://firestore.googleapis.com/v1/".concat(n,"?updateMask.fieldPaths=photo"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({fields:{photo:{arrayValue:{values:i}}}})}).then(()=>{l(!0),r(a)}).catch(e=>console.log(e))})})})})(l,t,e.name,P,C,a),m(!0)})},className:"lml rounded-md bg-white text-black w-[20vw]",children:"upload"}):(0,r.jsx)(r.Fragment,{})]})}let V=l.ZP.button(Z()),_=l.ZP.input(P()),E=l.ZP.textarea(N())},9700:function(e,t,n){"use strict";n.r(t),n.d(t,{curComments:function(){return u},curPostStore:function(){return h},default:function(){return m},idTokenStore:function(){return i},isLoginStore:function(){return s},isPostViewOpenStore:function(){return f},postCreatedStore:function(){return l},profileStore:function(){return o},selectedPointStore:function(){return d},userDataStore:function(){return c}});var a=n(3827);n(4090);var r=n(2153);let l=(0,r.cn)({key:"postCreated",default:!1}),o=(0,r.cn)({key:"profile",default:{}}),s=(0,r.cn)({key:"isLogin",default:!1}),u=(0,r.cn)({key:"curComments",default:""}),i=(0,r.cn)({key:"idTokenStore",default:""}),c=(0,r.cn)({key:"userDataStore",default:null}),d=(0,r.cn)({key:"selectedPointStore",default:""}),h=(0,r.cn)({key:"curPostStore",default:null}),f=(0,r.cn)({key:"isPostViewOpen",default:!1});function m(e){let{children:t}=e;return(0,a.jsx)(r.Wh,{children:t})}},8800:function(e,t,n){"use strict";n.d(t,{q:function(){return a}});let a={apiKey:"AIzaSyCA6Q_TA6dyl7wf2BtR_V_oEVIW2_Q94y0",authDomain:"daedongyourmap-ad63d.firebaseapp.com",projectId:"daedongyourmap-ad63d",storageBucket:"daedongyourmap-ad63d.appspot.com",messagingSenderId:"68098855208",appId:"1:68098855208:web:aa0e9a5602074a3b6c401d",measurementId:"G-7X00QEEQ08"}}},function(e){e.O(0,[691,723,869,75,486,740,4,672,971,69,744],function(){return e(e.s=4331)}),_N_E=e.O()}]);